	%
	% If you are looking for the PDF file, you can compile the .tex file or donwload the PDF from here:
	% 
	% 
	% Istruzioni di compilazione (per produrre il pdf): avere un texlive funzionante e i pacchetti che vengono richiesti qui sotto; lanciare i comandi
	% pdflatex gelmetti-phd_thesis
	% biber gelmetti-phd_thesis
	% makeglossaries gelmetti-phd_thesis
	% texindy gelmetti-phd_thesis.idx
	% pdflatex gelmetti-phd_thesis
	% pdflatex gelmetti-phd_thesis

	
	\documentclass[b5paper, 12pt, openright]{book} % URV suggests B5	
	\usepackage[utf8]{inputenc}
	%\usepackage[T1]{fontenc}% for using Bera Mono in Matlab listings
	\usepackage[spanish, es-noquoting, italian, catalan, british]{babel}
	% es-noquoting is needed for using < and > in siunitx https://github.com/josephwright/siunitx/issues/355#issuecomment-452731339
	
	\usepackage[product-units = single, list-units = single, range-units = single]{siunitx} % Typesetting quantities in a consistent way.
	% product-units controls if 1 x 1 m or 1 m x 1 m
	% I could set the rounding settings in the package options, but for having a better control I set a new alias for rounding numbers
	\newcommand{\rnum}[1]{\num[round-mode = figures, round-precision = 2]{#1}}
	
	
	\DeclareSIUnit\sq{\ensuremath\Box} % for the sheet resistance units https://tex.stackexchange.com/questions/71220/si-units-for-sheet-resistance-using-siunitx
	\DeclareSIUnit\Molar{M}
	\DeclareSIUnit\rpm{rpm}
	\DeclareSIUnit\eq{eq}
	\DeclareSIUnit\eV{eV}
	\DeclareSIUnit\ppm{ppm}
	\DeclareSIUnit\unit{unit}
	\DeclareSIUnit\year{yr}
	
	\usepackage{upgreek} % for avoiding the warning "Package chemmacros Warning: You haven't loaded any package for upright Greek"
	\usepackage{chemmacros} 		% for \ch{} and \iupac{}
	%\chemsetup{formula={chemformula}}
	%\chemsetup[chemformula]{font-shape=sf}
	%\chemsetup[chemformula]{format=\sffamily}
		
	\usepackage{verbatim} % for using curly braces inside \iupac of chemmacros
	
	% backref introduces the list of pages where the entry was cited, after each bibliography entry https://tex.stackexchange.com/a/211631/173645
	\usepackage[backend=biber, labelnumber=true, url=true, isbn=false, giveninits=true, sorting=none, maxnames=30, style=numeric-comp, hyperref=auto, backref=true]{biblatex}%
	
	% from https://tex.stackexchange.com/questions/278890/biblatex-suppressing-urldate-does-not-work-clearfield
	\AtEveryBibitem{\ifentrytype{article}{\clearfield{url}\clearfield{urlyear}}{}}
	%\AtEveryBibitem{\ifentrytype{article}{\togglefalse{bbx:url}}{}}
	
	% alternative solution that works also for \fullcite from https://tex.stackexchange.com/a/229505/173645
%	\DeclareSourcemap{
%		\maps[datatype=bibtex]{
%			\map{
%				\pertype{article}
%				\pertype{book}
%				\step[fieldset=urldate, null]
%				\step[fieldset=url, null]
%			}
%		}
%	}

% shorter alternative that works also for \fullcite from https://tex.stackexchange.com/a/175534/173645
\AtEveryCitekey{\UseBibitemHook}
		
		% seems that year is not nice here, removing
%	\newcommand{\authoryear}[1]{\citeauthor*{#1}~(\citeyear{#1}, \cite{#1})}
		\newcommand{\authoryear}[1]{\citeauthor*{#1}~\cite{#1}}
	
	\DeclareBibliographyCategory{mypapers}
	\addtocategory{mypapers}{Moia2019,Gelmetti2019,Gelmetti2017}
	
	%\usepackage{chemnum}			% Package used to manage index of compounds and schemes
	\usepackage{graphicx}
	\usepackage[textfont={small},format=plain]{subcaption} %the subfigure and subfig packages are deprecated. Specify the format in order to avoid the general caption format to apply also here https://tex.stackexchange.com/a/319870/173645
	\usepackage{ragged2e} % needed by ragged option of sidecap?
	
	
	%\usepackage{chngcntr} % needed for setting option not resetting footnote counter at chapter end
	%\usepackage{pgfplots} % graphs
	%\usepackage{booktabs}
	%\usepackage{lscape} %for big landscape figures, rotate the page
	%\usepackage{afterpage} %for making landscape float
	\usepackage[section]{placeins} %keeps floats `in their place', preventing them from floating past a "\FloatBarrier" command into another section.
	%\usepackage{float}
	\usepackage{eso-pic} %background image on titlepage
	\usepackage{transparent} %transparency for background image on titlepage
	
	\usepackage[format=plain, indention=-0.4cm, labelfont={small,bf}, textfont=small]{caption}%personalize figure and table captions
	\newcommand{\mycaption}[2][]{\caption[#1]{\textbf{#1} #2}}% to have also the short version printed, in bold

	\usepackage[ragged, centerbody, rightcaption, wide]{sidecap}%wide does not work neither setting marginparwidth in geometry, I have no idea why. centerbody is undocumented, I'm not sure it works.
	\captionsetup[SCfigure]{indention=0cm}
	
	% add a line below captions https://tex.stackexchange.com/a/14969/173645
	\DeclareCaptionFormat{myformat}{#1#2#3\vspace{-6pt}	\centerline{\rule[0.5ex]{0.8\linewidth}{0.7pt}}}%}\hrulefill}
	\captionsetup[figure]{format=myformat}
	
	% has to be loaded before hyperref https://tex.stackexchange.com/questions/485270/hyperref-and-titletoc-prints-extra-section-1-or-doc-startchapter-1/
	\usepackage{titletoc} % for adding a TOC at the beginning of each chapter, alternative to minitoc
%	\dottedcontents{paragraph}[0em]{}{0em}{1pc} % in each chapter toc, also the paragraph is included, but the indentation is too much
%	\dottedcontents{subsection}[0em]{}{0em}{1pc} % in each chapter toc, also the subsection is included, but the indentation is too much

	\usepackage{hyperref}

	\usepackage{xcolor} % for colors in hyperref links and in thumbs
	\definecolor{colorone}{HTML}{1B9E77}
	\definecolor{colortwo}{HTML}{d95f02}
		\definecolor{colorthree}{HTML}{7570B3}
		\definecolor{colorfour}{HTML}{E7298A}
		\definecolor{colorfive}{HTML}{66A61E}
		\definecolor{colorsix}{HTML}{E6AB02}
		\definecolor{colorseven}{HTML}{A6761D}
	\definecolor{coloreight}{HTML}{666666}
		
	\hypersetup{
		colorlinks,
		linkcolor={red!10!black},
		citecolor={black},
		urlcolor={blue!80!black},
%			bookmarks=true,         % show bookmarks bar?
%			unicode=false,          % non-Latin characters in Acrobat’s bookmarks
%			pdftoolbar=true,        % show Acrobat’s toolbar?
%			pdfmenubar=true,        % show Acrobat’s menu?
%			pdffitwindow=false,     % window fit to page when opened
%			pdfstartview={FitH},    % fits the width of the page to the window
%			pdftitle={My title},    % title
%			pdfauthor={Author},     % author
%			pdfsubject={Subject},   % subject of the document
%			pdfcreator={Creator},   % creator of the document
%			pdfproducer={Producer}, % producer of the document
			pdfkeywords={perovskite, solar cells, photovoltaics, photophysics, modelling, characterization, drift-diffusion, fabrication, hole transporting materials, recombination, simulation, ion migration, halide perovskite, hybrid perovskite, perovskite solar cells, impedance spectroscopy, solar energy, optical transients, electrical transients, data acquisition, data analysis, open circuit voltage, spin coating, hole transport layer, charge transfer, semiconductor, time resolved spectroscopy} % list of keywords
%			pdfnewwindow=true,      % links in new PDF window
%			colorlinks=false,       % false: boxed links; true: colored links
%			linkcolor=red,          % color of internal links (change box color with linkbordercolor)
%			citecolor=green,        % color of links to bibliography
%			filecolor=magenta,      % color of file links
%			urlcolor=cyan           % color of external links
	}


	
	%%%%%%%%%%%
	%%%%%%%%%%% GLOSSARIES
	%%%%%%%%%%%
	\usepackage[xindy, nonumberlist, acronym, nomain]{glossaries} %table of acronyms
	\makeglossaries % has to be after glossaries and after hyperref
	\setacronymstyle{long-sp-short}

%	\usepackage{relsize}%needed by textsmaller in glossaries
%	\renewcommand*{\acronymfont}[1]{\textsmaller{#1}}
	
	% for the table of symbols, this soultion could be used: https://tex.stackexchange.com/questions/348640/how-to-effectively-use-list-of-symbols-for-a-thesis
	
	%\usepackage{xspace} % for adding a conditional space in macros, dangerous as explained here: https://tex.stackexchange.com/questions/25820/no-space-following-macro-without-argument/25825#25825
	
	%%%%%%%%%%%
	%%%%%%%%%%% MULTIROW
	%%%%%%%%%%%
	\usepackage{multirow}% for tables
	%\usepackage[bottom,multiple]{footmisc} %bottom insert additional whitespace between the main text and the footnote rule rather than over-stretching the inter-paragraph glue AND to prevent the floats going below footnotes. This has to be loaded before fancyhdr
	
	%%%%%%%%%%%
	%%%%%%%%%%% FANCYHDR
	%%%%%%%%%%%
	\usepackage{fancyhdr}%page headers
%	\usepackage[hmarginratio=3:2, vmarginratio=1:1, b5paper, textwidth=13cm, textheight=20cm]{geometry}% marginparwidth inserted only for wide sidecaps. 
\usepackage[
b5paper,
bindingoffset=0.3in,
centering,
marginparwidth=0.2in,
textwidth=5.1in,
marginparsep=1em,
top=2.5cm,
bottom=2cm%,
%showframe
]{geometry}
%	\evensidemargin 1.5in
%	\oddsidemargin 1.5in
	
	%%%%%%%%%%%
	%%%%%%%%%%% MAKEIDX
	%%%%%%%%%%%
	\usepackage{makeidx} % for alphabetical index, using xindy or makeindex
	\makeindex

	
	%%%%%%%%%%%
	%%%%%%%%%%% AMSSYMB
	%%%%%%%%%%%
	\usepackage{amssymb}% for the \square math symbol

% this replaces the usage of \bm (bold in math), taken from https://tex.stackexchange.com/a/124311/173645
\makeatletter
\g@addto@macro\bfseries{\boldmath}
\makeatother
	
	\usepackage[super]{nth} % for superscript 1st 2nd, to be used with \nth{1}
	
	\usepackage{epigraph}% for inserting stupid phrases in random places
	\setlength{\epigraphrule}{0pt}% eliminate the rule below the epigraphs
	
	
	\usepackage{listings}
%	\usepackage[numbered,framed]{matlab-prettifier}% for Matlab listings highlighting
\usepackage{matlab-prettifier}% for Matlab listings highlighting
	\lstset{style=Matlab-editor, basicstyle=\footnotesize}% basicstyle has to be placed after style
	
	\usepackage{cleveref} % for automatic Figure or figure and for ranges
	%\crefdefaultlabelformat{#2\textbf{#1}#3} % bold numbers of references https://tex.stackexchange.com/a/255187/173645
	\creflabelformat{figure}{#2\textcolor{blue}{#1}#3} % blue numbers just for figures references
	
	\usepackage[spacing=true, stretch=40, shrink=40]{microtype} % automagically reduces overfull lines and improves justification

	\usepackage{titlesec}
	% standatard definitions from section 9.2 in titlesec manual
%\titleformat{\chapter}[display]{\normalfont\huge\bfseries}{\chaptertitlename\ \thechapter}{20pt}{\Huge}
%\titleformat{\section}{\normalfont\Large\bfseries}{\thesection}{1em}{}
%\titleformat{\subsection}{\normalfont\large\bfseries}{\thesubsection}{1em}{}
%\titleformat{\subsubsection}{\normalfont\normalsize\bfseries}{\thesubsubsection}{1em}{}
%\titleformat{\paragraph}[runin]{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
%\titleformat{\subparagraph}[runin]{\normalfont\normalsize\bfseries}{\thesubparagraph}{1em}{}
%\titlespacing*{\chapter}{0pt}{50pt}{40pt}
%\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
%\titlespacing*{\subsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
%\titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
%\titlespacing*{\paragraph}{0pt}{3.25ex plus 1ex minus .2ex}{1em}
%\titlespacing*{\subparagraph} {\parindent}{3.25ex plus 1ex minus .2ex}{1em}

% add negative spacing, maybe it could be done with \titlespacing
\titleformat{\section}{\normalfont\Large\bfseries}{\hspace*{-0.8cm}\thesection}{1em}{}
\titleformat{\subsection}{\normalfont\large\bfseries}{\hspace*{-0.8cm}\thesubsection}{1em}{}
\titleformat{\paragraph}[runin]{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{\hspace*{-0.8cm}}
	%\newcommand{\myp}[1]{\paragraph{\hspace*{-0.5cm}#1}}
	
	
% to be used in the specific chapter table of contents, via titletoc
	\titlecontents{lsection}[-1em]{ \normalfont \footnotesize \bfseries }{}{}{}[]
	\titlecontents{lsubsection}[1em]{ \normalfont \footnotesize \scshape }{}{}{}[]
	\titlecontents*{lparagraph}[3em]{\footnotesize \normalfont}{}{}{, \thecontentspage}[ \textbullet\ ][]
	
	\usepackage{etoolbox}
	% \sectionmark is broken for the page of first appearance
	% solution from https://tex.stackexchange.com/a/241299/173645
	% this sets the title for the ToC as the same of the section title, but the title for the header as a shorter alternative
	% usage: \mysection[header content]{index and title content}
	\usepackage{ifthen} % provides \ifthenelse test  
	\newcommand{\mysection}[2][]{
		\ifthenelse{\equal{#1}{}}%
			{\section{#2}}%
			{%
				\let\orisectionmark\sectionmark% solution from https://tex.stackexchange.com/a/241299/173645
				\renewcommand\sectionmark[1]{}%
				\section[#2]{#2\orisectionmark{#1}}%
				\orisectionmark{#1}%
				\let\sectionmark\orisectionmark%
			}%
	}
	
	\usepackage{needspace}
%	\preto\section{\vfil\penalty-10\vfilneg} % weakened \filbreak which would be \vfil\penalty-200\vfilneg % to avoid newpages to appear just below epitaphs, that usually are just after section names
%	\preto\section{\vskip 0pt plus 1fil\penalty-200\vskip 0pt plus -1fil}
	\preto\section{\needspace{7\baselineskip}}
	
	\usepackage{breqn} % for automatic line breaking in equations with dmath environment
	
%	\usepackage{commath} % for upright d in derivatives

	\usepackage{physics} % redefines plenty of things: \Im \Re \sin() \exp()... adds \dd for derivatives, \pdv for partial derivatives, \eval for evaluating the derivative in a point (does not work properly in dmath from breqn)
	
%	\usepackage{tabu} % like tabular and tabularx. "The package is, and will stay unmaintained unless a new maintainer steps forward."
	% in case just tabular was used, this can be used for having a line break in a cell
	\newcommand{\tallcell}[2][c]{\begin{tabular}[#1]{@{}c@{}}#2\end{tabular}}
	
\usepackage{xltabular}	%LaTeX package which combines longtable and tabularx. Loads package ltablex but keeps the current tabularx environment
% for vertical centering using multirow in combination with tabularx there's basically no good solution https://tex.stackexchange.com/questions/220411/vertically-align-multirow-in-tabularx-environment
		\renewcommand\tabularxcolumn[1]{m{#1}}% m for vertical centering text in each X column cell, https://tex.stackexchange.com/a/343329/173645
\newcolumntype{Y}{>{\centering\arraybackslash}X}% horizontal centering https://tex.stackexchange.com/a/89932/173645

% for including titlepage as pdf with includepdf
\usepackage{pdfpages} 

% for having the glossary on two columns
%\usepackage{glossary-mcols}

% to have line break (hyphenation) also at dashed words using \hyp{} https://en.wikibooks.org/wiki/LaTeX/Text_Formatting#Hyphenation
% htt allows hypenation also in typewriter, needed to avoid overfull boxes https://tex.stackexchange.com/a/10378/173645
\usepackage[htt]{hyphenat}

% useful for debugging hyphenation problems but it works just 
%\usepackage{showhyphens} % just for lualatex
%\usepackage{testhyphens}

% "implements a command, \afterpage, that causes the commands specified in its argument to be expanded after the current page is output"
% for making semi-float longtables https://tex.stackexchange.com/a/215443/173645
\usepackage{afterpage}


	%\usepackage{flafter}% seems very useful: floats after their definition, not before https://tex.stackexchange.com/questions/261542/what-kind-of-a-package-is-flafter
\usepackage[height={2cm},distance={2mm},topthumbmargin={auto},bottomthumbmargin={auto},width=0.6cm,eventxtindent=-2pt,oddtxtexdent=2pt]{thumbs}%

% like lscape, implements landscape environment for horizontal pages with normal headers, but also specifies the orientation in the PDF file
%\usepackage{pdflscape}
% on the contrary of lscape, rotating has a floating environment for images and tables
\usepackage{rotating}

	\usepackage[strict=true,autostyle=true, english = british]{csquotes} % for automatic direction of quotes, and for \enquote
\MakeOuterQuote{"}

% avoiding pagebreaks with \\* does not work if cline (tabular environment) is just after, this solves
% https://tex.stackexchange.com/a/52101/173645
\makeatletter
\def\@cline#1-#2\@nil{%
	\omit
	\@multicnt#1%
	\advance\@multispan\m@ne
	\ifnum\@multicnt=\@ne\@firstofone{&\omit}\fi
	\@multicnt#2%
	\advance\@multicnt-#1%
	\advance\@multispan\@ne
	\leaders\hrule\@height\arrayrulewidth\hfill
	\cr
	\noalign{\nobreak\vskip-\arrayrulewidth}}
\makeatother


	\renewcommand{\sfdefault}{cmbr}%for lighter sans serif
	\captionsetup[SCfigure]{format=plain}
	%\pgfplotsset{compat=newest}
	%\counterwithout{footnote}{chapter} % not resetting footnote counter at chapter end
	\newcommand{\HNMR}{$^1$\ch{H}-\textsmaller{NMR}}
	\newcommand{\CNMR}{$^{13}$\ch{C}-\textsmaller{NMR}}
	%\pgfplotsset{tick label style={font=\small},label style={font=\small}}
	%\let\oldch\ch %move the ch command, needed for redefinition
	%\renewcommand{\ch}[1]{\textsf{\oldch{#1}}} %add sans serif to \ch
	
	
	% \cmpd*[cmpd-label = 1S]{ig2-1}

	%\pgfplotsset{minor grid style={densely dotted,lightgray}}
	\newcommand{\acr}[1]{\gls{#1}\index{\glsdesc{#1}}} % for having the entry also in index
	\newcommand{\Acr}[1]{\Gls{#1}\index{\glsdesc{#1}}}
	
	
	\newcommand{\me}{\mathrm{e}} % for having upright neper number symbol, from https://tex.stackexchange.com/a/19491/173645
	\newcommand{\voc}{V_\mathrm{OC}} 
	\newcommand{\jsc}{J_\mathrm{SC}}
	
	\bibliography{biblio}
	
	\renewbibmacro*{name:andothers}{% Based on name:andothers from biblatex.def for "et al." in italic
	\ifboolexpr{
	test {\ifnumequal{\value{listcount}}{\value{liststop}}}
	and
	test \ifmorenames
	}
	{\ifnumgreater{\value{liststop}}{1}
	{\finalandcomma}
	{}%
	\andothersdelim\bibstring[\textsl]{andothers}}
	{}}
	

	\renewcommand{\floatpagefraction}{.8}% less likely to have images by their own in a page https://tex.stackexchange.com/questions/68516/avoid-that-figure-gets-its-own-page
		% N.B.: floatpagefraction MUST be less than topfraction !!
	\renewcommand{\topfraction}{.9}% default 0.7
	\renewcommand{\bottomfraction}{.8} % default 0.3
	\renewcommand{\textfraction}{.1}% default 0.2
	
% usually subscripts should be typed in upright font, like with \mathrm{}, unless they're indexes
% this allows me to use V_|OC| for upright subscripts
% https://tex.stackexchange.com/a/156963/173645
\makeatletter
\begingroup
\catcode`\_=\active
\protected\gdef_{\@ifnextchar|\subtextup\sb}
\endgroup
\def\subtextup|#1|{\sb{\textup{#1}}}
\AtBeginDocument{\catcode`\_=12 \mathcode`\_=32768}
\makeatother

% limit main table of content to sections, do not print subsections
\setcounter{tocdepth}{1}
	
	% no idea why but this hyphenation gets completely ignored :(
%	\hyphenation{tetra-hydro-furan
%		di-chlo-ro-methane
%		enantio-purity
%		oxy-methyl-ene
%		di-chroic
%		aceto-nitrile
%		iso-propyl
%		alk-oxy-amine
%		poly-thio-phene
%		di-chloride
%		inter-chain
%		photo-lu-mine-scence
%		supra-molecular
%		photo-gene-rated
%		hetero-junction
%		poly-thio-phenic
%		di-block
%		thio-phenic
%		poly-thio-phene
%		bi-layer
%		macro-initiator
%		poly-vinyl-pyridine
%		homo-polymer
%		path-length
%		intra-molecular
%		inter-molecular
%		hydro-chloric
%		poly-dispersity
%		poly-disperse
%		chlo-ro-ben-ze-ne
%		acetyl-acetone
%		di-iso-prop-oxide
%		acetyl-acet-on-ate
%		aceto-nitrile
%		ex-po-nen-tial
%		ex-po-nen-ti-als}
	
	\title{Advanced Characterization and Modelling of Charge Transfer in Perovskite Solar Cells}
	\author{Ilario Gelmetti}
	\date{2019}
	
\begin{document}
% I cite here the papers which should be numbered first	
\nocite{Gelmetti2017,Moia2019,Gelmetti2019}

\pagestyle{plain}

\selectlanguage{british}
\EnableQuotes
%\apptocmd{\@epitext}{\penalty=500}{}{}
%\apptocmd{\epigraph}{\nopagebreak}{}{}
%\AtEndEnvironment{\epigraphflush}{\nopagebreak}

% from a conversation with Martin.Muench@Uni-Bonn.de
%It would be more clear and "save" to just compile the titlepage (you can also compile the whole document, pdfpages just takes the first page) as titlepage.pdf and then use the pdfpages package, use
%\cleardoublepage%
%\@mainmatterfalse%
%from \frontmatter but with pagenumbering "alph" instead of the default "roman", include the titlepage.pdf and an empty page (therefore the "{}" in "pages={1,{}}"), and then start the "roman" pagenumbering.
%Thus LaTeX internally has pages a, b, i, ii and so on (unique page names). Might be "safer", in case some package relays on unique page names or on correspondence between page name and number. 
\makeatletter%
\cleardoublepage%
%\@mainmatterfalse%
\pagenumbering{alph}%
\makeatother%
% including the title page, compiled as a separate document
\includepdf[pages={1,2,3,4,5,6,7,{}},offset=0mm 0mm,frame=false,noautoscale=true,scale=1]{contents_tex/titlepage.pdf}%
\pagenumbering{roman}%



{\let\cleardoublepage\clearpage % i don't want openright in frontmatter
\frontmatter

%\addtocounter{page}{-1}

%\newpage

\chapter{Acknowledgements}
\input{contents_tex/acknowledgements.tex}
\clearpage

%%%%%%%%%%%%
% ACRONYMS %
%%%%%%%%%%%%

% techniques
\newacronym{pl}{PL}{photoluminescence}
\newacronym{uvvis}{UV--vis}{ultraviolet--visible}
\newacronym{nmr}{NMR}{nuclear magnetic resonance}
\newacronym{xrd}{XRD}{X--ray diffraction}
\newacronym{sem}{SEM}{scanning electron microscope}
\newacronym{esem}{ESEM}{environmental scanning electron microscopy}
\newacronym{edx}{EDX}{energy-dispersive X-ray analysis}
\newacronym{tpv}{TPV}{transient photovoltage}
\newacronym{tpvce}{TPV-CE}{transient photovoltage referred to charge from charge extraction}
\newacronym{tpvdc}{TPV-DC}{transient photovoltage referred to charge from differential capacitance}
\newacronym{tpc}{TPC}{transient photocurrent}
\newacronym{ce}{CE}{charge extraction}
\newacronym{dc}{DC}{differential capacitance}
\newacronym{mppt}{MPPT}{maximum power point tracking}
\newacronym{tcspc}{TCSPC}{time-correlated single photon counting}
\newacronym{kpfm}{KPFM}{Kelvin probe force microscopy}
\newacronym{afm}{AFM}{atomic force microscopy}
\newacronym{ac-afm}{AC-AFM}{alternating current atomic force microscopy}
\newacronym{trpl}{TRPL}{time-resolved photoluminescence}
\newacronym{ups}{UPS}{ultraviolet photoelectron spectroscopy}
\newacronym{cpd}{CPD}{contact potential difference}
\newacronym{dft}{DFT}{density functional theory}

% physical properties
\newacronym{homo}{HOMO}{highest-energy occupied molecular orbital}
\newacronym{lumo}{LUMO}{lowest-energy unoccupied molecular orbital}
\newacronym{ff}{FF}{fill factor}
\newacronym{pce}{PCE}{power conversion efficiency}
\newacronym{voc}{V\textsubscript{OC}}{open circuit voltage}
\newacronym{jsc}{J\textsubscript{SC}}{short circuit current}
\newacronym{eqe}{EQE}{external quantum efficiency}
\newacronym{dos}{DOS}{density of states}

% other
\newacronym{rt}{RT}{room temperature}
\newacronym{htm}{HTM}{hole transporting material}
\newacronym{etm}{ETM}{electron transporting material}
\newacronym{led}{LED}{light emitting diode}
\newacronym{osc}{OSC}{organic solar cells}
\newacronym{dssc}{DSSC}{dye sensitized solar cells}
\newglossaryentry{rctime}{name={RC time}, description={characteristic time of a circuit composed of a resistance in parallel to a capacitance}}
\newglossaryentry{loess}{name={LOESS},description={locally estimated scatterplot smoothing}}
\newacronym{gui}{GUI}{graphical user interface}
\newacronym{srh}{SRH}{Shockley\hyp{}Read\hyp{}Hall recombination} 

% long non-acronym names and descriptions

% molecules and materials
\newglossaryentry{pcbm60}{name={\ch{PC60BM}}, description={\iupac{[6,|6]-phen|yl C\textsubscript{61} butyric acid meth|yl ester}}}
\newglossaryentry{pcbm70}{name={\ch{PC70BM}}, description={\iupac{[6,|6]-phen|yl C\textsubscript{71} butyric acid meth|yl ester}}}
\newglossaryentry{ptfe}{name={\ch{PTFE}}, description={\iupac{poly|tetra|fluoro|ethyl|ene}}}
\newglossaryentry{fto}{name={\ch{FTO}}, description={fluorine tin oxide}}
\newglossaryentry{ito}{name={\ch{ITO}}, description={indium tin oxide}}
\newglossaryentry{pedotpss}{name={\ch{PEDOT:PSS}}, description={\iupac{poly\-(3,4-ethyl|ene|di|oxy|thio|phene) poly|(styr|ene|sulfon|ate)}}}
\newglossaryentry{mai}{name={\ch{MAI}}, description={\iupac{methyl|ammonium iod|ide}}}
\newglossaryentry{mabr}{name={\ch{MABr}}, description={\iupac{methyl|ammonium brom|ide}}}
\newglossaryentry{fai}{name={\ch{FAI}}, description={\iupac{formam|idinium iod|ide}}}
\newglossaryentry{dmso}{name={\ch{DMSO}}, description={\iupac{di|methyl sulf|oxide}}}
\newglossaryentry{dmf}{name={\ch{DMF}}, description={\iupac{N,N-di|methyl|form|amide}}}
\newglossaryentry{pes}{name={\ch{PES}}, description={\iupac{poly|ether|sulf|one}}}
\newglossaryentry{mapi}{name={\ch{MAPbI3}}, description={\iupac{methyl|ammonium lead iod|ide}}}
\newglossaryentry{mapicl}{name={\ch{MAPbI_{3-x}Cl_x}}, description={\iupac{methyl|ammonium lead iod|ide chlor|ide}}}
\newglossaryentry{famapbibr}{name={\ch{FAMAPbIBr}}, description={\iupac{formam|idinium methyl|ammonium lead iod|ide brom|ide}}}
\newglossaryentry{csfamapbibr}{name={\ch{CsFAMAPbIBr}}, description={\iupac{cesium formam|idinium methyl|ammonium lead iod|ide brom|ide}}}
\newglossaryentry{csfamapbibr_complete}{name={\ch{Cs_{0.06}FAMA_{0.2}Pb_{1.3}I_{3.2}Br_{0.6}}}, description={\iupac{cesium formam|idinium methyl|ammonium lead iod|ide brom|ide}}}
\newglossaryentry{litfsi}{name={\ch{LiTFSI}}, description={\iupac{bis|(tri|fluoro|methane)|sulfon|imide lithium salt}}}
\newglossaryentry{spiro}{name={\iupac{spiro-OMeTAD}},description={\iupac{N^{2},|N^{2},|N^{2'},|N^{2'},|N^{7},|N^{7},|N^{7'},|N^{7'}-octa|kis|(4-meth|oxy|phenyl)|-9,|9'-spiro|bi|[9H-fluor|ene]|-2,2',7,7'-tetr|amine}}}
\newglossaryentry{tae1}{name={TAE-1},description={\iupac{tetra|\{4-[N,N-(4,4'-di|meth|oxy|di|phen|yl|amino)]phen|yl\}|eth|ene}}}
\newglossaryentry{tae3}{name={TAE-3},description={\iupac{3,|3',|6,|6'-tetra|kis[N,|N-bis|(4-meth|oxy|phen|yl)|amino]-9,|9'-bi|fluor|en|yl|id|ene}}}
\newglossaryentry{tae4}{name={TAE-4},description={\iupac{3,|3',|6,|6'-tetra|kis(3,|6-di|meth|oxy-|9H-carba|zol-9-yl)-9,|9'-bi|fluor|en|yl|id|ene}}}
\newglossaryentry{ptaa}{name={PTAA}, description={\iupac{poly|[bis(4-phen|yl)(2,|4,|6-tri|methyl|phen|yl)|amine}}}
\newglossaryentry{thf}{name={THF}, description={\iupac{tetrahydrofuran}}}
\newglossaryentry{dcm}{name={DCM}, description={\iupac{dichloromethane}}}

% symbols
\newglossaryentry{symb:v}{name={$v$}, description={ideality of pseudo first order life-time \textsl{versus} light bias}}
\newglossaryentry{symb:m}{name={$m$}, description={ideality of charge density \textsl{versus} light bias}}
\newglossaryentry{symb:mu}{name={$\mu$}, description={internal chemical potential}, sort={mu}}
\newglossaryentry{symb:barmu}{name={$\bar\mu$}, description={electrons electrochemical potential, the quasi-Fermi level energy of electrons including the local electrostatic potential}, sort={mubar}}
\newglossaryentry{symb:V}{name={\ensuremath{V}}, description={voltage}}
\newglossaryentry{symb:P}{name={\ensuremath{P}}, description={electrical power}}
\newglossaryentry{symb:J}{name={\ensuremath{J}}, description={current or current density}}
\newglossaryentry{symb:phi}{name={\ensuremath{\phi}}, description={illumination intensity}, sort={phi}}
\newglossaryentry{symb:nid}{name={\ensuremath{n_{\mathrm{id}}}}, description={ideality factor}}
\newglossaryentry{symb:kB}{name={\ensuremath{k_{\mathrm{B}}}}, description={Boltzmann constant}}
\newglossaryentry{symb:T}{name={\ensuremath{T}}, description={temperature}}
\newglossaryentry{symb:Jph}{name={\ensuremath{J_{\mathrm{ph}}}}, description={photogenerated current}}
\newglossaryentry{symb:J0}{name={\ensuremath{J_0}}, description={dark diode saturation current}}
\newglossaryentry{symb:alpha}{name={\ensuremath{\alpha}}, description={power law exponent in current \textsl{versus} illumination intensity relationship}, sort={alpha}}
\newglossaryentry{symb:q}{name={\ensuremath{q}}, description={elementary charge}}
\newglossaryentry{symb:n}{name={\ensuremath{n}}, description={electrons density}}
\newglossaryentry{symb:p}{name={\ensuremath{p}}, description={electron holes density}}
\newglossaryentry{symb:ni}{name={\ensuremath{n_{\mathrm{i}}}}, description={equilibrium carrier density (electrons and holes participating in conduction) for an intrinsic (non\hyp{}doped) semiconductor}}
\newglossaryentry{symb:epsilonzero}{name={\ensuremath{\epsilon_0}}, description={electric constant}, sort={epsilonzero}}
\newglossaryentry{symb:epsilonr}{name={\ensuremath{\epsilon_{\mathrm{r}}}}, description={relative permittivity}, sort={epsilonr}}
\newglossaryentry{symb:Eg}{name={\ensuremath{E_{\mathrm{g}}}}, description={band gap}}
\newglossaryentry{symb:A}{name={\ensuremath{A}}, description={area}}
\newglossaryentry{symb:d}{name={\ensuremath{d}}, description={distance, thickness}}
\newglossaryentry{symb:Cg}{name={\ensuremath{C_{\mathrm{g}}}}, description={geometric capacitance}}
\newglossaryentry{symb:Cion}{name={\ensuremath{C_{\mathrm{ion}}}}, description={ionic capacitance}}
\newglossaryentry{symb:g}{name={\ensuremath{g}}, description={charges photo-generation rate}}
\newglossaryentry{symb:U}{name={\ensuremath{U}}, description={charges recombination rate}}
\newglossaryentry{symb:t}{name={\ensuremath{t}}, description={time}}
\newglossaryentry{symb:tau}{name={\ensuremath{\tau}}, description={small perturbation recombination life-time}, sort={tau}}
\newglossaryentry{symb:taupfo}{name={\ensuremath{\tau_{\mathrm{pfo}}}}, description={pseudo first order recombination life-time}, sort={taupfo}}
\newglossaryentry{symb:Phi}{name={\ensuremath{\Phi}}, description={reaction order}, sort={Phi}}
\newglossaryentry{symb:C}{name={\ensuremath{C}}, description={capacitance}}
\newglossaryentry{symb:Zre}{name={\ensuremath{Z'}}, description={real component of complex impedance}}
\newglossaryentry{symb:Zim}{name={\ensuremath{Z''}}, description={imaginary component of complex impedance}}
\newglossaryentry{symb:omega}{name={\ensuremath{\omega}}, description={angular frequency}, sort={omega}}
\newglossaryentry{symb:ux}{name={\ensuremath{u_x}}, description={placeholder for useless constants}}
\newglossaryentry{symb:VE}{name={\ensuremath{V_{\mathrm{E}}}}, description={electrostatic potential, energy for adding a positive elementary charge}}
\newglossaryentry{symb:Rs}{name={\ensuremath{R_{\mathrm{s}}}}, description={series resistance}}
\newglossaryentry{symb:Rsh}{name={\ensuremath{R_{\mathrm{sh}}}}, description={shunt resistance}}
\newglossaryentry{symb:nCE}{name={\ensuremath{n_{\mathrm{CE}}}}, description={excess charge observable \textsl{via} charge extraction}}
\newglossaryentry{symb:nDOS}{name={\ensuremath{n_{\mathrm{DOS}}}}, description={density of states}}
\newglossaryentry{symb:VBI}{name={\ensuremath{V_{\mathrm{BI}}}}, description={built-in voltage}}
\newglossaryentry{symb:ECB}{name={\ensuremath{E_{\mathrm{CB}}}}, description={conduction band energy}}
\newglossaryentry{symb:EVB}{name={\ensuremath{E_{\mathrm{VB}}}}, description={valence band energy}}
\newglossaryentry{symb:neq}{name={\ensuremath{n_{\mathrm{eq}}}}, description={equilibrium carrier density for a two levels system}}
\newglossaryentry{symb:k}{name={\ensuremath{k}}, description={recombination rate constant}}
\newglossaryentry{symb:Jrec}{name={\ensuremath{J_{\mathrm{rec}}}}, description={recombination current}}
\newglossaryentry{symb:nu}{name={\ensuremath{\nu}}, description={frequency}, sort={frequency}}
\newglossaryentry{symb:f}{name={\ensuremath{f}}, description={mathematical function}}
\newglossaryentry{symb:CDC}{name={\ensuremath{C_{\mathrm{DC}}}}, description={Voltage dependent capacitance obtained from DC measurements}}
%\newglossaryentry{symb:Eox}{name={\ensuremath{E_{\mathrm{ox}}}}, description={Oxidation potential form cyclovoltammetry measurements}}
%\newglossaryentry{symb:W}{name={\ensuremath{W}}, description={Work function}}
\newglossaryentry{symb:theta}{name={\ensuremath{\theta}}, description={phase}, sort={theta}}
\newglossaryentry{symb:rho}{name={\ensuremath{\rho}}, description={net charge density}, sort={rho}}
%\newglossaryentry{symb:}{name={\ensuremath{}}, description={}, sort={}}
%\newglossaryentry{symb:}{name={\ensuremath{}}, description={}, sort={}}
%\newglossaryentry{symb:}{name={\ensuremath{}}, description={}, sort={}}
%\newglossaryentry{symb:}{name={\ensuremath{}}, description={}, sort={}}
%\newglossaryentry{symb:}{name={\ensuremath{}}, description={}, sort={}}
%\newglossaryentry{symb:}{name={\ensuremath{}}, description={}, sort={}}
%\newglossaryentry{symb:}{name={\ensuremath{}}, description={}, sort={}}
%\newglossaryentry{symb:}{name={\ensuremath{}}, description={}, sort={}}
%\newglossaryentry{symb:}{name={\ensuremath{}}, description={}, sort={}}




\tableofcontents
\listoffigures
\listoftables
%\lstlistoflistings

\glsaddall
%\setglossarystyle{mcolindex}
%\renewcommand*{\glsmcols}{2}
\printglossary[type=\acronymtype, title={Glossary, Acronyms, and Symbols}]


\cleardoublepage \vspace*{12cm}
\begin{flushright}
	\large {\it Dedicata a So$\phi$a.}
\end{flushright}

%\newgeometry{top=1in, bottom=1in, outer=1in, inner=1in}


\chapter[Abstract]{\centering Abstract - Sinopsis - Sinopsi}
\input{contents_tex/abstract.tex}

\chapter[Summary of the Thesis]{\centering Summary of the Thesis}
\input{contents_tex/summary.tex}


	\printbibliography[category=mypapers, heading=bibintoc, title={Contributions to Scientific Literature}]


\chapter{Oral and Poster Presentations at Conferences}
\begin{itemize}
	\item 45 min plenary oral presentation, at \textit{International Krutyn Summer School on Advanced Perovskite, Hybrid and Thin-film Photovoltaics} in Krutyn, Poland on June the 14th, 2016 titled \textit{"How to make efficient perovskite solar cells and charge transfer reactions in perovskite solar cell"}
	\item 20 min plenary oral presentation at \textit{Workshop on Flexible Electronics} in DEEEA-URV, Tarragona, Spain on June the 29th, 2016 titled \textit{"Photophysical characterization of charge transfer and recombination in hybrid lead halide perovskite solar cells"}
	\item 15 min plenary oral presentation at \textit{Stability of Emerging Photovoltaics Conference} (SEPV18) in Barcelona, Spain on February the 20th, 2018 titled \textit{"The Relevance of the Energy Alignment Shift in Organic Semiconductor/Perovskite Interface: Influence in the Open Circuit Voltage"}
	\item Poster at \textit{International Conference on Hybrid and Organic Photovoltaics} (HOPV17) in Lausanne, Switzerland on May the 22nd, 2017 titled \textit{"Quasi-Fermi Energy Shift for Hole Transport Material in Perovskite Solar Cells"}
	\item 30 min invited seminar oral presentation in INAM-UJI, Castelló, Spain on June the 26th, 2018 titled \textit{"Simulating Impedance Spectroscopy of Pervoskite-based Devices via Time-Dependent 1D Drift-Diffusion Model"}
	\item 15 min plenary oral presentation in \textit{Graduate Students Meeting on Electronics Engineering} in DEEEA-URV, Tarragona, Spain on June the 28th, 2018 titled \textit{"Simulating the impedance spectroscopy of an hybrid perovskite solar cells via time-dependent 1D driftdiffusion model"}
	\item 15 min oral presentation in \textit{NanoBio Conference 2018} in Heraklion, Crete, Greece on September the 27th, 2018 titled \textit{"Perovskite solar cells impedance spectroscopy explained via 1D time dependent drift-diffusion modelling"}
\end{itemize}



	}%here ends openany and starts openright


	\fancypagestyle{plain}{% chapter pages use style plain
		\renewcommand{\headrulewidth}{0pt} % no top rule
		\fancyhf{}% clear all fields
		\fancyfoot[L]{\footnotesize{Ilario Gelmetti}}% left footer
		\fancyfoot[C]{\footnotesize{\textit{Photophysics of perovskite}}}
		\fancyfoot[R]{\thepage}% right footer
	}

	\mainmatter
	\pagestyle{headings}
	\EnableQuotes % I didn't understand why, but this command has to be present in some parts of the code

\chapter{Introduction}\label{ch:intro}
	\epigraph{\textit{"It's good, unless you have vertigo."\\"\dots are you talking about PhD?"}}

	\addthumb{\thechapter}{\LARGE{\textbf{\thechapter}}}{white}{colorone}

%Important to finish this paragraph, for example with an empty line for avoiding the following error:
% .ptc Something's wrong--perhaps a missing \item. ...rline {4.1}Introduction}{89}{section.4.1}
	\paragraph*{Table of Contents} \rule[0.5ex]{0.5\linewidth}{1pt}
	
	\startcontents[intro]
	\printcontents[intro]{l}{1}{\setcounter{tocdepth}{4}}

	\centerline{\rule[0.5ex]{0.5\linewidth}{1pt}}

	\graphicspath{ {./contents_img/intro/} }

	\newpage
	\input{contents_tex/intro.tex}
	\clearpage
	\stopcontents[intro]

\chapter{Experimental Methods}\label{ch:methods}
\chaptermark{Experimental Methods}
	\epigraph{\textit{"When it's a humid day, we don't fabricate cells"\\"But\dots  don't you fabricate them in a glovebox?"\\"Of course."}}

	\addthumb{\thechapter}{\LARGE{\textbf{\thechapter}}}{white}{colortwo}

	\paragraph*{Abstract} The experimental methods are described here in detail, mixed with comments and warnings to the reader, trying to underline the critical points spotted over my PhD.
	Needless saying, the critical points in fabricating a complex electronic device such as a perovskite solar cells are many and neither a proper description can assure reproducibility.

%Important to finish this paragraph, for example with an empty line for avoiding the following error:
% .ptc Something's wrong--perhaps a missing \item. ...rline {4.1}Introduction}{89}{section.4.1}
	\paragraph*{Table of Contents} \rule[0.5ex]{0.5\linewidth}{1pt}
	
	\startcontents[methods]
	\printcontents[methods]{l}{1}{\setcounter{tocdepth}{4}}

	\centerline{\rule[0.5ex]{0.5\linewidth}{1pt}}

	\graphicspath{ {./contents_img/methods/} }

	\newpage
%	\input{contents_tex/methods.tex}
	\clearpage
	\stopcontents[methods]

\chapter{Characterisation Techniques: Description and Interpretation}\label{ch:characterization}
\chaptermark{Characterization Techniques}
	\epigraph{\textit{""}}

	\addthumb{\thechapter}{\LARGE{\textbf{\thechapter}}}{white}{colorthree}


	\paragraph*{Abstract} Characterization of perovskite solar cells is a non-trivial subject, the techniques researchers successfully employed for \gls{osc} and \gls{dssc} needs to be re-validated for this new kind of solar cells.
	The presence of ionic migration in the absorber can be a game-changer for which special care has to be taken.
	In this chapter the employed characterisation techniques are described and critically assessed.
	Taking advantage of drift\hyp{}diffusion simulations, some new hypotheses are thrown about the interpretation of the characterisation output.

%Important to finish this paragraph, for example with an empty line for avoiding the following error:
% .ptc Something's wrong--perhaps a missing \item. ...rline {4.1}Introduction}{89}{section.4.1}
	\paragraph*{Table of Contents} \rule[0.5ex]{0.5\linewidth}{1pt}
	
	\startcontents[characterization]
	\printcontents[characterization]{l}{1}{\setcounter{tocdepth}{4}}

	\centerline{\rule[0.5ex]{0.5\linewidth}{1pt}}

	\graphicspath{ {./contents_img/characterization/} }

	\newpage
%	\input{contents_tex/characterization.tex}
	\clearpage
	\stopcontents[characterization]

\chapter{Comparison of HTM in Bottom Cathode CsFAMAPbIBr Solar Cells by Means of PhotoPhysical and Chemical Characterization}\label{ch:tae}
\chaptermark{Comparing HTM}
	\epigraph{\textit{"It's so easy, can't you see the shift?"}}

	\addthumb{\thechapter}{\LARGE{\textbf{\thechapter}}}{white}{colorfour}

	\paragraph*{Publication} Part of this chapter has been published in \cite{Gelmetti2019}: \fullcite{Gelmetti2019}.

	\paragraph*{Abstract}
	In this chapter, the well known \gls{spiro}, the previously reported \gls{tae1} and two novel molecules \gls{tae3} and \gls{tae4} were employed as \gls{htm} for fabricating perovskite solar cells.
	The lack of correlation between the molecules' ionization potentials and the devices measured \gls{voc} motivated us to deepen the investigation on the factors contributing to the cell voltage by means of transient optoelectronic techniques.
	We gained insight into the recombination process and the energy alignment at perovskite\-/\gls{htm} interface.

%Important to finish this paragraph, for example with an empty line for avoiding the following error:
% .ptc Something's wrong--perhaps a missing \item. ...rline {4.1}Introduction}{89}{section.4.1}
	\paragraph*{Table of Contents} \rule[0.5ex]{0.5\linewidth}{1pt}
	
	\startcontents[tae]
	\printcontents[tae]{l}{1}{\setcounter{tocdepth}{4}}
	\centerline{\rule[0.5ex]{0.5\linewidth}{1pt}}

	\graphicspath{ {./contents_img/tae/} }

	\newpage
%	\input{contents_tex/tae.tex}
	\clearpage
	\stopcontents[tae]

\chapter{Insights on the Charge Storage \textsl{via} Thickness Variation of Layers in Top Cathode MAPI Solar Cells by Means of PhotoPhysical Characterization}\label{ch:thicknesses}
\chaptermark{Thickness of Layers}
	\epigraph{\textit{"Let's change as little as possible"}}

	\addthumb{\thechapter}{\LARGE{\textbf{\thechapter}}}{white}{colorfive}

	\paragraph*{Publication} Part of this chapter has been published in \cite{Gelmetti2017}: \fullcite{Gelmetti2017}.

	\paragraph*{Abstract}
	All-organic, solution processed, top cathode, two step perovskite deposition \gls{ito}\-/\gls{pedotpss}\-/\gls{mapi}\-/\gls{pcbm70}\-/\ch{Ag} devices were fabricated and studied by means of current-voltage sweeps, \acr{ce}, \acr{tpv}, and \acr{dc}.
	Small variations in each layer thickness were introduced, so that we could compare the effect of this change on the resulting device characteristics.
	Characterization via current-voltage sweeps and photophysical techniques allowed us to study the charge distribution in these devices.
	Specifically, we have measured devices' capacitance under illumination using photo-induced time resolved techniques and obtained indications about holes and electrons storage location.

%Important to finish this paragraph, for example with an empty line for avoiding the following error:
% .ptc Something's wrong--perhaps a missing \item. ...rline {4.1}Introduction}{89}{section.4.1}
	\paragraph*{Table of Contents} \rule[0.5ex]{0.5\linewidth}{1pt}
	
	\startcontents[thicknesses]
	\printcontents[thicknesses]{l}{1}{\setcounter{tocdepth}{4}}
	\centerline{\rule[0.5ex]{0.5\linewidth}{1pt}}

	\graphicspath{ {./contents_img/thicknesses/} }

	\newpage
%	\input{contents_tex/thicknesses.tex}
	\clearpage
	\stopcontents[thicknesses]

\chapter{Influence of Ionic Motion on Electronic Recombination as Observable in Impedance Spectroscopy}\label{ch:impedance}
\chaptermark{Impedance Sectroscopy}
	\epigraph{\textit{"We don't see that plateau"}}

	\addthumb{\thechapter}{\LARGE{\textbf{\thechapter}}}{white}{colorsix}

	\paragraph*{Publication}
	Part of this chapter has been published in \cite{Moia2019}: \fullcite{Moia2019}.

	\paragraph*{Abstract}
	Driftfusion modelling platform allowed me to simulate the current evolution in a perovskite solar cell when applying an oscillating voltage, in presence of constant illumination.
	From this simple simulation we could reproduce the experimentally observed giant or negative capacitance and gain insight on their likely origin.
	The ionic migration in the perovskite layer behaves as a capacitive current of charges accumulating next to the interfaces with the contacts.
	The capacitive origin of this ionic current implies it happens out of phase with the applied oscillating voltage.
	We show that accumulation and depletion of ionic charge at the interfaces modulates surface recombination and charge injection, causing respectively giant capacitance and negative capacitance (\textsl{i.e.} inductance).

%Important to finish this paragraph, for example with an empty line for avoiding the following error:
% .ptc Something's wrong--perhaps a missing \item. ...rline {4.1}Introduction}{89}{section.4.1}
	\paragraph*{Table of Contents} \rule[0.5ex]{0.5\linewidth}{1pt}
	
	\startcontents[impedance]
	\printcontents[impedance]{l}{1}{\setcounter{tocdepth}{4}}

	\centerline{\rule[0.5ex]{0.5\linewidth}{1pt}}

	\graphicspath{ {./contents_img/impedance/} }
		\input{contents_tex/impedance.tex}
	\clearpage
	\stopcontents[impedance]

\chapter{Software Development for Drift-Diffusion Modelling, Data Acquisition and Data Analysis}\label{ch:software}
\chaptermark{Software Development}
	\epigraph{\textit{\enquote{GIGO: Garbage In, Garbage Out}}}

	\addthumb{\thechapter}{\LARGE{\textbf{\thechapter}}}{white}{colorseven}

	\paragraph*{Publication}
	The source code of software included in this chapter has been released and can be accessed online.
	The drift\hyp{}diffusion Matlab routines have been published on the \texttt{2018-EIS} branch of the Driftfusion repository, directly accessible from \url{https://github.com/barnesgroupICL/Driftfusion/tree/2018-EIS}.
	The current\hyp{}voltage sweep acquisition Python software can be downloaded from \url{https://github.com/ilario/PyPV}.
	The data processing R routines can be examined at \url{https://github.com/ilario/photophysics-data-processing-R}.

	\paragraph*{Abstract}
	During my PhD thesis I wrote code mainly for three projects: current\hyp{}voltage sweep data acquisition, processing and analysis routines for various kinds of characterisation data, physical modelling of perovskite solar cells.
	All of this work is intended to be re-used by others, so this chapter will detail how to use it and describe the design choices.

%Important to finish this paragraph, for example with an empty line for avoiding the following error:
% .ptc Something's wrong--perhaps a missing \item. ...rline {4.1}Introduction}{89}{section.4.1}
	\paragraph*{Table of Contents} \rule[0.5ex]{0.5\linewidth}{1pt}
	
	\startcontents[software]
	\printcontents[software]{l}{1}{\setcounter{tocdepth}{4}}

	\centerline{\rule[0.5ex]{0.5\linewidth}{1pt}}
	
	\newpage
	\graphicspath{ {./contents_img/software/} }
%	\input{contents_tex/software.tex}
	\clearpage
	\stopcontents[software]


	\appendix
		\EnableQuotes % I didn't understand why, but this command has to be present in some parts of the code
	
	\stopthumb


	\backmatter
		\EnableQuotes % I didn't understand why, but this command has to be present in some parts of the code

\chapter{Overall Conclusions}\label{ch:conclusions}
	\input{contents_tex/conclusions.tex}
	\clearpage

	\printindex

	\printbibliography[heading=bibintoc]

	\cleardoublepage
	\phantom{Ciao Mamma!}
	\thispagestyle{empty} % nothing printed on the internal side of the back cover
	\newpage

	% the closing page has to be on an even page
	\includepdf[pages={1},offset=0mm 0mm,frame=false,noautoscale=true,scale=1]{contents_img/titlepage/B5_contra_iciq_icl.pdf}%

\end{document}
